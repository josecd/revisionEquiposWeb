"use strict";(self.webpackChunkrevisionEquipos=self.webpackChunkrevisionEquipos||[]).push([[777],{6777:(L,T,r)=>{r.d(T,{G:()=>I,k:()=>Zt});var m=r(5861),t=r(5879),P=r(2787),E=r(729),u=r(1486),Z=r(8337),p=r(5313),d=r(6223),S=r(6676),O=r(3445),x=r(3680),C=r(6814),Y=r(5986),D=r(8034),b=r(9157),B=r(2032),y=r(8525),M=r(5195),w=r(2296),k=r(2596);function Q(e,a){if(1&e&&(t.TgZ(0,"span",33),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.AsE(" (+",((null==o.toppings.value?null:o.toppings.value.length)||0)-1," ",2===(null==o.toppings.value?null:o.toppings.value.length)?"otro":"otros",") ")}}function J(e,a){if(1&e&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o),t.xp6(1),t.Oqu(o.nombre)}}function F(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Assigned "),t.qZA())}function K(e,a){if(1&e&&(t.TgZ(0,"td",37)(1,"div",38)(2,"div",39)(3,"h6",40),t._uU(4),t.qZA(),t.TgZ(5,"span",41),t._uU(6),t.qZA()()()()),2&e){const o=a.$implicit;t.xp6(4),t.hij(" ",o.uname," "),t.xp6(2),t.hij(" ",o.position," ")}}function W(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," ID "),t.qZA())}function q(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.idReporte," ")}}function $(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Name "),t.qZA())}function j(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.productName," ")}}function H(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Priority "),t.qZA())}function G(e,a){if(1&e&&(t.TgZ(0,"span",44),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,o.priority)," ")}}function V(e,a){if(1&e&&(t.TgZ(0,"span",45),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,o.priority)," ")}}function X(e,a){if(1&e&&(t.TgZ(0,"span",46),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,o.priority)," ")}}function z(e,a){if(1&e&&(t.TgZ(0,"span",47),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,o.priority)," ")}}function tt(e,a){if(1&e&&(t.TgZ(0,"span",48),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,o.priority)," ")}}function et(e,a){if(1&e&&(t.TgZ(0,"td",37),t.YNc(1,G,3,3,"ng-template",43),t.YNc(2,V,3,3,"ng-template",43),t.YNc(3,X,3,3,"ng-template",43),t.YNc(4,z,3,3,"ng-template",43),t.YNc(5,tt,3,3,"ng-template",43),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Q6J("ngIf","low"==o.priority),t.xp6(1),t.Q6J("ngIf","medium"==o.priority),t.xp6(1),t.Q6J("ngIf","high"==o.priority),t.xp6(1),t.Q6J("ngIf","critical"==o.priority),t.xp6(1),t.Q6J("ngIf","moderate"==o.priority)}}function ot(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Budget "),t.qZA())}function at(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" $",o.budget,"k ")}}function nt(e,a){1&e&&t._UZ(0,"tr",49)}function it(e,a){1&e&&t._UZ(0,"tr",50)}function lt(e,a){if(1&e&&(t.TgZ(0,"div",15)(1,"mat-card",0)(2,"mat-card-content",1)(3,"mat-card-title"),t._uU(4,"Recorridos"),t.qZA(),t.TgZ(5,"div",16)(6,"table",35),t.ynx(7,24),t.YNc(8,F,2,0,"th",22),t.YNc(9,K,7,2,"td",20),t.BQk(),t.ynx(10,21),t.YNc(11,W,2,0,"th",22),t.YNc(12,q,2,1,"td",23),t.BQk(),t.ynx(13,25),t.YNc(14,$,2,0,"th",22),t.YNc(15,j,2,1,"td",23),t.BQk(),t.ynx(16,27),t.YNc(17,H,2,0,"th",22),t.YNc(18,et,6,5,"td",20),t.BQk(),t.ynx(19,28),t.YNc(20,ot,2,0,"th",22),t.YNc(21,at,2,1,"td",23),t.BQk(),t.YNc(22,nt,1,0,"tr",31),t.YNc(23,it,1,0,"tr",32),t.qZA()()()()()),2&e){const o=t.oxw();t.xp6(6),t.Q6J("dataSource",o.dataSource2),t.xp6(16),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns)}}function pt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"th",51)(1,"mat-checkbox",52),t.NdJ("change",function(s){t.CHM(o);const l=t.oxw();return t.KtG(s?l.toggleAllRows():null)}),t.qZA()()}if(2&e){const o=t.oxw();t.xp6(1),t.Q6J("checked",o.selection.hasValue()&&o.isAllSelected())("indeterminate",o.selection.hasValue()&&!o.isAllSelected())("aria-label",o.checkboxLabel())}}function rt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",37)(1,"mat-checkbox",53),t.NdJ("click",function(s){return s.stopPropagation()})("change",function(s){const c=t.CHM(o).$implicit,h=t.oxw();return t.KtG(s?h.selection.toggle(c):null)}),t.qZA()()}if(2&e){const o=a.$implicit,n=t.oxw();t.xp6(1),t.Q6J("checked",n.selection.isSelected(o))("aria-label",n.checkboxLabel(o))}}function st(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," ID "),t.qZA())}function ct(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.idReporte," ")}}function _t(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Tipo "),t.qZA())}function mt(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.tipoReporte," ")}}function ut(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Descripci\xf3n "),t.qZA())}function dt(e,a){if(1&e&&(t.TgZ(0,"td",54),t._uU(1),t.ALo(2,"slice"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("matTooltip",o.descripcion),t.xp6(1),t.AsE(" ",t.Dn7(2,3,o.descripcion,0,50),"",o.descripcion.length>50?"...":""," ")}}function ht(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Hotel "),t.qZA())}function gt(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.hoteles.nombre," ")}}function ft(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Fecha "),t.qZA())}function At(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,o.fechaRegistro)," ")}}function xt(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Firmas "),t.qZA())}function Ct(e,a){if(1&e&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",o.firmas.length," ")}}function vt(e,a){1&e&&(t.TgZ(0,"th",51),t._uU(1," Acciones "),t.qZA())}function Tt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",37)(1,"button",55),t.NdJ("click",function(){const l=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.getRecord(l))}),t._uU(2,"Ver"),t.qZA()()}}function Pt(e,a){1&e&&t._UZ(0,"tr",49)}function Et(e,a){1&e&&t._UZ(0,"tr",50)}const U=S,I={parse:{dateInput:"MM/YYYY"},display:{dateInput:"MM/YYYY",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};let Zt=(()=>{class e{constructor(){this._reporte=(0,t.f3M)(E.c),this.router=(0,t.f3M)(P.F0),this.displayedColumns=["select","id","assigned","name","priority","budget","firmas","accion"],this.displayedColumnsReporte=["select","usuario","descripcion","hotel","fechaRegistro","firmas"],this.selection=new Z.Ov(!0,[]),this.dataSource2=new p.by([]),this.date=new d.NI(U()),this.toppings=new d.NI(""),this.toppingList=["Extra cheese","Mushroom","Onion","Pepperoni","Sausage","Tomato"],this.hoteles=[]}ngOnInit(){this.mes=U().month(),this.anio=U().year(),this.getReportes(),this.getHoteles()}setMonthAndYear(o,n){const s=this.date.value;s.month(o.month()),s.year(o.year()),this.date.setValue(s),this.mes=this.date.value?.month(),this.anio=this.date.value?.year(),n.close()}getReportes(){this._reporte.reportesFiltro({mes:this.mes+1,anio:this.anio,hotel:""}).subscribe({next:n=>{this.dataSource2=new p.by(n)},error:n=>{}})}getHoteles(){this._reporte.hotelesLista().subscribe({next:o=>{this.hoteles=o},error:o=>{}})}getRecord(o){this.router.navigate(["/reportesAlta/detalle",o.idReporte])}exportexcel(){let n=document.getElementById("table");const s=u.P6.table_to_sheet(n),l=u.P6.book_new();u.P6.book_append_sheet(l,s,"Sheet1"),u.NC(l,"ExcelSheet.xlsx")}exportData(){var n=[["ID","EQUIPO","MARCA","MODELO","N\xb0 SERIE","\xc1REA","CRITICIDAD","HOTEL","USUARIO","OBSERVACI\xd3N","RECOMENDACIONES","COMENTARIO DE GERENCIA","CR\xcdTICO BAJO","CR\xcdTICO ALTO","FIRMAS"]];this.selection._selected.forEach(function(){var s=(0,m.Z)(function*(l){let c=0,h=0,f=l.firmas.length;for(var _=0;_<l.observaciones.length;++_)c="Bajo"==l.observaciones[_].criticidad?c+1:c,h="Alto"==l.observaciones[_].criticidad?h+1:h,(i=[]).push(l.idReporte),i.push(l.observaciones[_].equipo),i.push(l.observaciones[_].marca),i.push(l.observaciones[_].modelo),i.push(l.observaciones[_].numeroSerie),i.push(l.observaciones[_].area),i.push(l.observaciones[_].criticidad),i.push(l.hoteles.nombre),i.push(l.usuario.nombre),i.push(l.observaciones[_].observacion),i.push(l.observaciones[_].comentarios.map(g=>g.comentario+"/").toString()),i.push(""),n.push(i);var i;(i=[]).push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(l.recomendaciones),i.push(c),i.push(h),i.push(f),n.push(i)});return function(l){return s.apply(this,arguments)}}()),this.exportToCsv("reporte.csv",n)}exportToCsv(o,n){for(var s=function(i){for(var R="",g=0;g<i.length;g++){var N=null==i[g]?"":i[g].toString();i[g]instanceof Date&&(N=i[g].toLocaleString());var v=N.replace(/"/g,'""');v.search(/("|,|\n)/g)>=0&&(v='"'+v+'"'),g>0&&(R+=","),R+=v}return R+"\n"},l="",c=0;c<n.length;c++)l+=s(n[c]);var h=new Blob(["\ufeff"+l],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a");if(void 0!==f.download){var _=URL.createObjectURL(h);f.setAttribute("href",_),f.setAttribute("download",o),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}}isAllSelected(){return this.selection.selected.length===this.dataSource2.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource2.data)}checkboxLabel(o){return o?`${this.selection.isSelected(o)?"deselect":"select"} row ${o.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}applyFilter(o){this.dataSource2.filter=o.target.value.trim().toLowerCase()}buscar(){this.selection.clear(),this.hotelesSeleccionados="";const o=this.toppings.value;this.hotelesSeleccionados=o?o.map(s=>s.idHotel):"";const n={mes:this.mes+1,anio:this.anio,hotel:this.hotelesSeleccionados.toString()||""};this._reporte.reportesFiltro(n).subscribe({next:s=>{this.dataSource2=new p.by(s)}})}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sample-page"]],features:[t._Bn([{provide:x._A,useClass:O.t7,deps:[x.Ad,O.o8]},{provide:x.Ad,useValue:"es-ES"},{provide:x.sG,useValue:I}])],decls:61,vars:11,consts:[[1,"cardWithShadow"],[1,"p-24"],[1,"d-flex","w-100"],[1,"row"],[1,"col"],["matInput","",3,"matDatepicker","formControl"],["matIconSuffix","",3,"for"],["startView","multi-year","panelClass","example-month-picker",3,"monthSelected"],["dp",""],["multiple","",3,"formControl"],["class","example-additional-selection",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary","matBadgePosition","before","matBadgeColor","accent",3,"click"],["mat-flat-button","","color","primary","matBadgePosition","before","matBadgeColor","accent",1,"m-l-auto",3,"click"],["class","col-lg-12",4,"ngIf"],[1,"col-lg-12"],[1,"table-responsive","m-t-16"],["id","table","mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","assigned"],["matColumnDef","name"],["mat-cell","","class","mat-body-1 truncate-text",3,"matTooltip",4,"matCellDef"],["matColumnDef","priority"],["matColumnDef","budget"],["matColumnDef","firmas"],["matColumnDef","accion"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"example-additional-selection"],[3,"value"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14"],["mat-cell",""],[1,"d-flex","align-items-center"],[1,"m-l-16"],[1,"mat-subtitle-1","f-s-14","f-w-600"],[1,"mat-body-1","f-s-12"],["mat-cell","",1,"mat-body-1"],[3,"ngIf"],[1,"bg-light-accent","text-accent","rounded","f-w-600","p-6","p-y-4","f-s-12"],[1,"bg-light-primary","text-primary","rounded","f-w-600","p-6","p-y-4","f-s-12"],[1,"bg-light-warning","text-warning","rounded","f-w-600","p-6","p-y-4","f-s-12"],[1,"bg-light-error","text-error","rounded","f-w-600","p-6","p-y-4","f-s-12"],[1,"bg-light-success","text-success","rounded","f-w-600","p-6","p-y-4","f-s-12"],["mat-header-row",""],["mat-row",""],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],[3,"checked","aria-label","click","change"],["mat-cell","",1,"mat-body-1","truncate-text",3,"matTooltip"],["mat-raised-button","","color","primary",3,"click"]],template:function(o,n){if(1&o){const s=t.EpF();t.TgZ(0,"mat-card",0)(1,"mat-card-content",1)(2,"div",2)(3,"section")(4,"div",3)(5,"div",4)(6,"mat-form-field")(7,"mat-label"),t._uU(8,"Mes y A\xf1o"),t.qZA(),t._UZ(9,"input",5)(10,"mat-datepicker-toggle",6),t.TgZ(11,"mat-datepicker",7,8),t.NdJ("monthSelected",function(c){t.CHM(s);const h=t.MAs(12);return t.KtG(n.setMonthAndYear(c,h))}),t.qZA()()(),t.TgZ(13,"div",4)(14,"mat-form-field")(15,"mat-label"),t._uU(16,"Hoteles"),t.qZA(),t.TgZ(17,"mat-select",9)(18,"mat-select-trigger"),t._uU(19),t.YNc(20,Q,2,2,"span",10),t.qZA(),t.YNc(21,J,2,2,"mat-option",11),t.qZA()()()(),t.TgZ(22,"div",4)(23,"button",12),t.NdJ("click",function(){return n.buscar()}),t._uU(24," Buscar "),t.qZA(),t.TgZ(25,"button",13),t.NdJ("click",function(){return n.exportData()}),t._uU(26," Exportar excel "),t.qZA()()()()()(),t.YNc(27,lt,24,3,"div",14),t.TgZ(28,"div",15)(29,"mat-card",0)(30,"mat-card-content",1)(31,"mat-card-title"),t._uU(32,"Recorridos"),t.qZA(),t.TgZ(33,"div",16)(34,"table",17),t.ynx(35,18),t.YNc(36,pt,2,3,"th",19),t.YNc(37,rt,2,2,"td",20),t.BQk(),t.ynx(38,21),t.YNc(39,st,2,0,"th",22),t.YNc(40,ct,2,1,"td",23),t.BQk(),t.ynx(41,24),t.YNc(42,_t,2,0,"th",22),t.YNc(43,mt,2,1,"td",23),t.BQk(),t.ynx(44,25),t.YNc(45,ut,2,0,"th",22),t.YNc(46,dt,3,7,"td",26),t.BQk(),t.ynx(47,27),t.YNc(48,ht,2,0,"th",22),t.YNc(49,gt,2,1,"td",23),t.BQk(),t.ynx(50,28),t.YNc(51,ft,2,0,"th",22),t.YNc(52,At,3,3,"td",23),t.BQk(),t.ynx(53,29),t.YNc(54,xt,2,0,"th",22),t.YNc(55,Ct,2,1,"td",23),t.BQk(),t.ynx(56,30),t.YNc(57,vt,2,0,"th",19),t.YNc(58,Tt,3,0,"td",20),t.BQk(),t.YNc(59,Pt,1,0,"tr",31),t.YNc(60,Et,1,0,"tr",32),t.qZA()()()()()}if(2&o){const s=t.MAs(12);t.xp6(9),t.Q6J("matDatepicker",s)("formControl",n.date),t.xp6(1),t.Q6J("for",s),t.xp6(7),t.Q6J("formControl",n.toppings),t.xp6(2),t.hij(" ",(null==n.toppings.value||null==n.toppings.value[0]?null:n.toppings.value[0].nombre)||""," "),t.xp6(1),t.Q6J("ngIf",((null==n.toppings.value?null:n.toppings.value.length)||0)>1),t.xp6(1),t.Q6J("ngForOf",n.hoteles),t.xp6(6),t.Q6J("ngIf",!1),t.xp6(7),t.Q6J("dataSource",n.dataSource2),t.xp6(25),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns)}},dependencies:[C.sg,C.O5,x.ey,Y.oG,D.Mq,D.hl,D.nW,b.KE,b.hX,b.R9,B.Nt,y.gD,y.$L,M.a8,M.dn,M.n5,w.lW,k.gM,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,d.Fj,d.JJ,d.oH,C.OU,C.rS,C.uU],styles:[".mat-column-assigned[_ngcontent-%COMP%]{max-width:80px!important;min-width:80px!important}.mat-column-name[_ngcontent-%COMP%]{max-width:100px!important;min-width:100px!important}.truncate-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px}"]}),e})()},729:(L,T,r)=>{r.d(T,{c:()=>E});var m=r(5516),t=r(5879),P=r(9862);let E=(()=>{class u{constructor(p){this._httpClient=p}getReportes(){return this._httpClient.get(m.N.API_URL+"/reportes")}getReporteID(p){return this._httpClient.get(m.N.API_URL+`/reportes/${p}/alto`)}verPDF(p,d){let A;"Recorrido"==d?A=m.N.API_URL+"/reportes/pdf/view/"+p:"Baja"==d?A=m.N.API_URL+"/reportes/pdf/view/"+p+"/Baja":"Mantenimiento"==d&&(A=m.N.API_URL+"/reportes/pdf/view/"+p+"/Mantenimiento"),window.open(A,"_blank")}descargarPDF(p){window.open(m.N.API_URL+`/reportes/${p}/pdfReporte`,"_blank")}hotelesLista(){return this._httpClient.get(m.N.API_URL+"/hoteles")}reportesFiltro(p){return this._httpClient.post(m.N.API_URL+"/reportes/filter2",p)}reportesFiltroexs(p){return this._httpClient.post(m.N.API_URL+"/reportes/filterExcel",p)}}return u.\u0275fac=function(p){return new(p||u)(t.LFG(P.eN))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);